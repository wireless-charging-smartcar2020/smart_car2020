C51 COMPILER V9.57.0.0   MAIN                                                              12/26/2020 09:10:50 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: F:\MDK5.21A\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\timing_charge) DEBUG OBJECTEX
                    -TEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "main.h"
   2          #define CHARGE_TIME 10
   3          uchar second=CHARGE_TIME;
   4            void main()        
   5          { 
   6   1      CSA=0;    //L 有效,字库片选
   7   1      CSB=0;    //L 有效,屏片选
   8   1      RST=0;    //L 有效,屏复位 
   9   1      A0=0;   //L:command; H:data,命令/数据 
  10   1      SCK =0;//时钟   
  11   1      SI=0;//数据输入 
  12   1      SO =0;//数据输出 
  13   1      BL=0;   //L 有效,背光控制 
  14   1      //  //buzzer=1;
  15   1      //  jidianqi=0;
  16   1      //  TMOD=0x01;
  17   1      //  TH0=(65536-46080)/256;
  18   1      //  TL0=(65536-46080)%256;
  19   1      //  EA=1;
  20   1      //  ET0=1;
  21   1      //  TR0=1;
  22   1      //  while(1)  
  23   1      //    {  
  24   1      //    //led1=0;
  25   1      //      if(second==0)     // 60  
  26   1      //      {
  27   1      //        second=0; 
  28   1      //        A1=0;A2=0;        
  29   1      //        //buzzer=0;
  30   1      //        delay(50000);
  31   1      //        jidianqi=1;
  32   1      //        display(A1,A2);
  33   1      //      }
  34   1      //      A1=second/10;     
  35   1      //      A2=second%10;  
  36   1      //      //display(A1,A2); 
  37   1      //    }  
  38   1      } 
  39          /*
  40          50ms*20=1s
  41          0.05/(12/11059200)=46080
  42          */
  43          void T0_time() interrupt 1
  44          {
  45   1        TH0=(65536-46080)/256;
  46   1        TL0=(65536-46080)%256;
  47   1        num++;
  48   1        if(num==20)
  49   1        {
  50   2          num=0;
  51   2          if(second>0)
  52   2              second--;      
  53   2        }
  54   1      }
C51 COMPILER V9.57.0.0   MAIN                                                              12/26/2020 09:10:50 PAGE 2   

  55          
  56          
  57          
  58          //..........串口写.......... 
  59          void serial_write(uchar lcm_cmd_or_data) 
  60          { 
  61   1        uchar i;    
  62   1        CSB=0;    
  63   1        for(i=0;i<8;i++) 
  64   1        {
  65   2        SCK=0;   
  66   2          if((lcm_cmd_or_data&0x80)==0x80)      
  67   2            SI=1;   
  68   2          else      
  69   2            SI=0;   
  70   2          //SCK=0;  
  71   2          _nop_();  
  72   2          _nop_();    
  73   2          SCK=1;
  74   2          _nop_();
  75   2          SCK=0;  
  76   2          lcm_cmd_or_data=lcm_cmd_or_data<<1; 
  77   2      } 
  78   1        CSB=1; 
  79   1      } 
  80          //..........写命令.......... 
  81          void send_cmd(uchar lcm_cmd) 
  82          { 
  83   1        A0=0; 
  84   1        serial_write(lcm_cmd); 
  85   1      } 
  86          //..........写数据到 DDRAM.......... 
  87          void send_data(uchar lcm_data) 
  88          { 
  89   1        A0=1; 
  90   1        serial_write(lcm_data); 
  91   1      } 
  92          //==================display a piture of 16*16 dots================
  93          void display_graphic_16x16(char page,char column,char *dp)
  94          {
  95   1        char i,j;
  96   1        for(j=0;j<2;j++)
  97   1        {
  98   2          //lcd_address(page+j,column);
  99   2          set_page_address(page+j);     
 100   2          set_column_address(column); 
 101   2          for (i=0;i<16;i++)
 102   2          { 
 103   3            send_data(*dp);   
 104   3            dp++;
 105   3          }
 106   2        }
 107   1      }
 108          //..........写页地址.......... 
 109          void set_page_address(uchar page_addr) 
 110          { 
 111   1        send_cmd(page_addr|0xb0); 
 112   1      } 
 113          //..........写列地址.......... 
 114          void set_column_address(uchar clm_addr) 
 115          { 
 116   1        send_cmd((clm_addr>>4)|0x10);   //送列地址高四位 
C51 COMPILER V9.57.0.0   MAIN                                                              12/26/2020 09:10:50 PAGE 3   

 117   1        send_cmd(clm_addr&0x0f);    //送列地址低四位 
 118   1      } 
 119          //..........初始化.......... 
 120          void lcm_init(void) 
 121          { 
 122   1        delay(3);  
 123   1          RST=0;    
 124   1        delay(3);   
 125   1        RST=1;    
 126   1        delay(6); 
 127   1        send_cmd(0xAE);
 128   1        send_cmd(0xE2);//Software reset
 129   1        send_cmd(0xa0); //0xA0左右镜像选择，0xA1正常显示  
 130   1        send_cmd(0xc8); //0xC0上下镜像选择，0xC8正常显示
 131   1        send_cmd(0x25);//set (Rb/Ra) 
 132   1        send_cmd(0xa2);//bias set:1/9 
 133   1        send_cmd(0x81);//vo output voltage set 
 134   1        send_cmd(0x10);   //0~63
 135   1        send_cmd(0xf8),//booster ratio set
 136   1        send_cmd(0x00),//booster ratio:4x
 137   1        send_cmd(0x2c);//升压步聚1 
 138   1        send_cmd(0x2e);//升压步聚2 
 139   1        send_cmd(0x2f);//升压步聚3
 140   1        send_cmd(0x40); //起始行：第一行开始 
 141   1      //  send_cmd(0xe0);   
 142   1      
 143   1        send_cmd(0xaf);//开显示
 144   1      } 
 145          //..........延时 n 毫秒.......... 
 146          void delay(uint ms) 
 147          { 
 148   1        uint i,j;   
 149   1        for(i=0;i<ms;i++)     
 150   1        for(j=0;j<20000;j++); 
 151   1      } 
 152          void display(uchar sh_c,uchar g_c)      
 153          {  
 154   1        lcm_init(); 
 155   1        BL = 0;
 156   1        while(1) 
 157   1      {   
 158   2      delay(01); 
 159   2          display_graphic_16x16(1,8,huan);
 160   2      delay(01); 
 161   2          display_graphic_16x16(1,(8+16),ying);
 162   2      delay(01); 
 163   2          display_graphic_16x16(1,(8+16*2),ni);
 164   2      delay(05);        //waitkey();
 165   2      }
 166   1      //***************数码管显示*******************//
 167   1      //  //dula=0; 
 168   1      //  dula=1;   
 169   1      //  P0=table[sh_c];     
 170   1      //  dula=0;  
 171   1      //  P0=0xff;
 172   1      //  
 173   1      //  wela=1;
 174   1      //  P0=0xfe;  
 175   1      //  wela=0;  
 176   1      //  delay(500);       // 5ms  
 177   1      //  
 178   1      //  dula=1; 
C51 COMPILER V9.57.0.0   MAIN                                                              12/26/2020 09:10:50 PAGE 4   

 179   1      //  P0=table[g_c];      
 180   1      //  dula=0;   
 181   1      //  P0=0xff;
 182   1      //  
 183   1      //  wela=1;  
 184   1      //  P0=0xfd;  
 185   1      //  wela=0;  
 186   1      //  delay(500);       // 5ms  
 187   1      //****************数码管************************//
 188   1      }  
*** WARNING C280 IN LINE 152 OF main.c: 'sh_c': unreferenced local variable
*** WARNING C280 IN LINE 152 OF main.c: 'g_c': unreferenced local variable


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    393    ----
   CONSTANT SIZE    =     96    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
